(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    164676,       4291]
NotebookOptionsPosition[    158266,       4145]
NotebookOutlinePosition[    158607,       4160]
CellTagsIndexPosition[    158564,       4157]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"At", "=", 
    RowBox[{"Import", "[", 
     RowBox[{"\"\<C:\\\\Output_1881695243.TXT\>\"", ",", "\"\<Table\>\""}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.773310997838425*^9, 3.77331101610047*^9}, {
   3.77400329322174*^9, 3.774003323186454*^9}, 3.774003492668147*^9, 
   3.7740974082131133`*^9, 3.7741560050284233`*^9, 3.774258655365196*^9, {
   3.7743631671288743`*^9, 3.7743631881109114`*^9}, {3.774410128707053*^9, 
   3.774410129502655*^9}, {3.77441100363879*^9, 3.774411025291628*^9}, {
   3.7744111147889843`*^9, 3.774411134008218*^9}, {3.774411206860345*^9, 
   3.7744112098399496`*^9}, {3.7744112930192947`*^9, 3.774411293190895*^9}, {
   3.774411372329833*^9, 3.774411373265835*^9}, {3.7744114092082977`*^9, 
   3.7744114321403375`*^9}, {3.774416577265685*^9, 3.774416581914493*^9}, 
   3.7744167578672*^9, {3.7744168484118185`*^9, 3.7744168490358195`*^9}, 
   3.774426108504055*^9, 
   3.774867552639168*^9},ExpressionUUID->"38ef253f-3652-443b-a37b-\
359962bd9c97"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"h", "=", "0.001"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"M", "=", 
    RowBox[{"MatrixForm", "[", "At", "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Kx", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"M", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "i", ",", "4"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"M", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "1"}], "}"}]}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ky", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"M", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "i", ",", "5"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"M", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "1"}], "}"}]}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Kz", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"M", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "i", ",", "6"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"M", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "1"}], "}"}]}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7733110120542383`*^9, 3.773311043850057*^9}, {
   3.7733112250144196`*^9, 3.7733112270295343`*^9}, {3.7733113059930506`*^9, 
   3.77331130772915*^9}, 3.7733148670307302`*^9, {3.7740034563230686`*^9, 
   3.7740034618693857`*^9}, 3.7740034965203676`*^9, {3.774416919360742*^9, 
   3.774416936895173*^9}, {3.7744261166160693`*^9, 3.774426119970075*^9}, {
   3.7744265778776736`*^9, 3.77442658155928*^9}, {3.774867552654768*^9, 
   3.774867552654768*^9}},ExpressionUUID->"4b94e030-90f5-4608-ae57-\
3c1c51bb50e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Aksel", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Normalize", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"M", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "i", ",", " ", "1"}], "]"}], "]"}], ",", 
         RowBox[{"M", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "i", ",", " ", "2"}], "]"}], "]"}], ",", 
         RowBox[{"M", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "i", ",", " ", "3"}], "]"}], "]"}]}], "}"}], 
       "]"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", 
       RowBox[{"Length", "[", 
        RowBox[{"M", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7733176050423145`*^9, 3.7733176326378927`*^9}, {
  3.7733176678799086`*^9, 3.7733176684499407`*^9}, {3.7733200066506786`*^9, 
  3.7733200122830005`*^9}, {3.7733209232651052`*^9, 3.7733209241041536`*^9}, {
  3.7742593119627514`*^9, 3.7742593189401503`*^9}, {3.774361152682073*^9, 
  3.774361154119276*^9}, {3.7743627513887997`*^9, 3.7743627592748137`*^9}, {
  3.774410171591528*^9, 3.774410173900332*^9}, {3.774410280308118*^9, 
  3.7744102824765215`*^9}, {3.774426520219973*^9, 3.774426521483575*^9}, {
  3.7748648964693365`*^9, 3.7748649052365522`*^9}, {3.774867552670368*^9, 
  3.774867552670368*^9}},ExpressionUUID->"32c9b2b3-3a4d-4b61-9f20-\
f6a60436a0ae"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.023323"}], ",", 
     RowBox[{"-", "0.438206"}], ",", "0.066518"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"A1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5.349270", ",", "0.178976", ",", "0.066518"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.178976", ",", "5.910940", ",", 
       RowBox[{"-", "0.012636"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.236383"}], ",", 
       RowBox[{"-", "0.012636"}], ",", "5.583866"}], "}"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.774077371590424*^9, 3.774077372353468*^9}, {
  3.774362598745714*^9, 3.774362621544756*^9}, {3.774416617607355*^9, 
  3.7744166253293686`*^9}, {3.774416767804417*^9, 3.7744167932480617`*^9}, {
  3.7744168533882275`*^9, 3.774416860205439*^9}, {3.7744260937932296`*^9, 
  3.774426095306432*^9}, {3.774426126818487*^9, 3.774426130749694*^9}, {
  3.774522196882783*^9, 
  3.774522202514393*^9}},ExpressionUUID->"7eb8e575-f850-46b9-8208-\
dfc33f54c57d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Magn", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"-", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"-", 
            RowBox[{"A1", ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"M", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "i", ",", " ", "7"}], "]"}], "]"}], ",", 
                 RowBox[{"M", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "i", ",", " ", "8"}], "]"}], "]"}], ",", 
                 RowBox[{"M", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "i", ",", " ", "9"}], "]"}], "]"}]}], 
                "}"}], "-", "b"}], ")"}]}]}], ")"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"A1", ".", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"M", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "i", ",", " ", "7"}], "]"}], "]"}], ",", 
                RowBox[{"M", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "i", ",", " ", "8"}], "]"}], "]"}], ",", 
                RowBox[{"M", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "i", ",", " ", "9"}], "]"}], "]"}]}], 
               "}"}], "-", "b"}], ")"}]}], ")"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"A1", ".", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"M", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "i", ",", " ", "7"}], "]"}], "]"}], ",", 
                RowBox[{"M", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "i", ",", " ", "8"}], "]"}], "]"}], ",", 
                RowBox[{"M", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "i", ",", " ", "9"}], "]"}], "]"}]}], 
               "}"}], "-", "b"}], ")"}]}], ")"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", 
       RowBox[{"Length", "[", 
        RowBox[{"M", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7733176547551575`*^9, 3.7733176657857885`*^9}, {
   3.77331999531603*^9, 3.773320002152421*^9}, {3.773320919710902*^9, 
   3.773320920701959*^9}, {3.7740773672831774`*^9, 3.7740773970878825`*^9}, {
   3.7740780713024454`*^9, 3.774078078921881*^9}, {3.7740781233304214`*^9, 
   3.774078127467658*^9}, {3.774078693810354*^9, 3.774078701883816*^9}, {
   3.774259340332374*^9, 3.7742593482898293`*^9}, {3.774361157242282*^9, 
   3.7743611585848837`*^9}, {3.7743624278005776`*^9, 3.774362431096184*^9}, {
   3.7743627648178234`*^9, 3.774362786024662*^9}, {3.774362974176228*^9, 
   3.774362976346632*^9}, {3.774410165928718*^9, 3.7744101672235203`*^9}, {
   3.7744102702461*^9, 3.774410275394109*^9}, {3.774410504937121*^9, 
   3.774410507199125*^9}, {3.7744106482233706`*^9, 3.7744106490345716`*^9}, {
   3.774410823021675*^9, 3.774410824519278*^9}, {3.7744111265202045`*^9, 
   3.774411128064607*^9}, {3.7744261447741184`*^9, 3.7744261460221205`*^9}, {
   3.774426511015957*^9, 3.7744265179267693`*^9}, 3.774858447207879*^9, {
   3.774867552685968*^9, 
   3.774867552685968*^9}},ExpressionUUID->"b750d39a-c643-4abc-b4b6-\
9646b5e35c42"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7733196330963125`*^9, 3.7733196382816086`*^9}, 
   3.773319722419421*^9, {3.773319863853511*^9, 3.773319889888*^9}, 
   3.773319949074385*^9, 3.7733200581136217`*^9, 3.773320113655799*^9, {
   3.773320168643944*^9, 3.773320170096027*^9}, {3.773320297491314*^9, 
   3.773320422474462*^9}, {3.7733204876561904`*^9, 3.773320532526757*^9}, {
   3.773320955948975*^9, 3.773320956746021*^9}, 3.7740038027428827`*^9, {
   3.774005518251004*^9, 3.774005576889358*^9}, {3.774005630438421*^9, 
   3.7740056708017297`*^9}, 3.7740776412068453`*^9, 3.7740778780823936`*^9, {
   3.7740779786931486`*^9, 3.774078045729983*^9}, {3.774078155325251*^9, 
   3.7740782078892574`*^9}, {3.7740785382524567`*^9, 
   3.7740785593186617`*^9}, {3.774080576115016*^9, 3.774080619671507*^9}, {
   3.774165989186341*^9, 3.774166014551985*^9}, {3.7745222219988265`*^9, 
   3.7745222224824276`*^9}, 3.7745231312464123`*^9, {3.7745233167931356`*^9, 
   3.7745233225027456`*^9}},ExpressionUUID->"2d5d8122-c25a-41bb-9331-\
932a118e6310"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7740789547272778`*^9, 3.774079001880975*^9}, {
   3.7740790337857995`*^9, 3.7740790698348618`*^9}, 3.7745222252904325`*^9, 
   3.774523132993615*^9},ExpressionUUID->"b25c0d92-cd39-449b-bf44-\
2ae026f22268"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"J", "=", 
  RowBox[{"Inverse", "[", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Normalize", "[", 
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{"Normalize", "[", 
          RowBox[{"Cross", "[", 
           RowBox[{
            RowBox[{"Aksel", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"Magn", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"Aksel", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
      RowBox[{"Normalize", "[", 
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{"Aksel", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"Magn", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", " ", 
      RowBox[{"Normalize", "[", 
       RowBox[{"Aksel", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], " ", "}"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NewMagn", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"J", ".", 
      RowBox[{"Magn", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", 
       RowBox[{"Length", "[", 
        RowBox[{"M", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NewAksel", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"J", ".", 
      RowBox[{"Aksel", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"M", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7740778823086357`*^9, 3.7740778963774405`*^9}, {
   3.7740798875726337`*^9, 3.7740798947000413`*^9}, {3.774079935886397*^9, 
   3.7740800095706115`*^9}, {3.7740856768247595`*^9, 
   3.7740856808559904`*^9}, {3.7740865817665195`*^9, 
   3.7740865932731776`*^9}, {3.7740868443675394`*^9, 3.774086851321937*^9}, {
   3.774087092780748*^9, 3.7740871194332724`*^9}, {3.7740874291179852`*^9, 
   3.7740874321941614`*^9}, {3.7740876684966764`*^9, 
   3.7740876845255938`*^9}, {3.774088025018069*^9, 3.7740880439721527`*^9}, {
   3.774088222131343*^9, 3.774088228040681*^9}, {3.774093280242283*^9, 
   3.774093332595278*^9}, 3.7741627919631286`*^9, {3.7745231346316175`*^9, 
   3.7745231627428665`*^9}, 3.7745232299633837`*^9, 3.774705415579673*^9, {
   3.774867552685968*^9, 3.7748675527015676`*^9}, 
   3.7750341853780394`*^9},ExpressionUUID->"e3817934-65b9-49be-b0b8-\
4680429eb16d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.5508652065954937`", ",", 
     RowBox[{"-", "0.11434609132669267`"}], ",", 
     RowBox[{"-", "0.8267239536633807`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.8345158159556375`", ",", "0.061887672743595766`", ",", 
     "0.5474972775112932`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.011440152201811007`"}], ",", 
     RowBox[{"-", "0.9915114156481957`"}], ",", "0.12951538733644796`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7750341858304405`*^9},ExpressionUUID->"3ebb4ca3-57af-43f8-b445-\
0e467f629141"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"A", "[", "590", "]"}]], "Input",
 CellChangeTimes->{{3.7745233305523596`*^9, 3.7745233305523596`*^9}, {
  3.7747041943627434`*^9, 3.7747041985591507`*^9}, {3.7747054063444567`*^9, 
  3.774705414487671*^9}, {3.7748673363291907`*^9, 3.7748673437392035`*^9}, {
  3.774868691768754*^9, 
  3.774868702719973*^9}},ExpressionUUID->"c746cff6-2c0b-4b8b-9d4c-\
3cf1f9f34143"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1.`", ",", 
     RowBox[{"-", "0.000014809`"}], ",", "5.239`*^-6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.000014809`", ",", "1.`", ",", 
     RowBox[{"-", "0.000012383999999999999`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5.239`*^-6"}], ",", "0.000012383999999999999`", ",", 
     "1.`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7748673407283983`*^9, 3.7748673441136045`*^9}, {
  3.7748686685715137`*^9, 
  3.7748687032971745`*^9}},ExpressionUUID->"43002550-be27-4ab5-a4f7-\
4c74497bd091"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Em", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "[", "t_", "]"}], ":=", 
   RowBox[{"Em", "-", 
    RowBox[{"h", "*", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"girz", "[", "t", "]"}], ",", 
         RowBox[{"-", 
          RowBox[{"giry", "[", "t", "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"girz", "[", "t", "]"}]}], ",", "0", ",", 
         RowBox[{"girx", "[", "t", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"giry", "[", "t", "]"}], ",", 
         RowBox[{"-", 
          RowBox[{"girx", "[", "t", "]"}]}], ",", "0"}], "}"}]}], "}"}]}]}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Na", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0.228388362", ",", "0.190708685", ",", "0.290119621"}], "}"}], 
    "/", "9.81"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Ng", "=", 
   RowBox[{"{", 
    RowBox[{"0.108275463", ",", "0.125510985", ",", "0.067926358"}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Nm", "=", 
   RowBox[{"{", 
    RowBox[{"0.006743677", ",", "0.003452758", ",", "0.007068613"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Norm", "[", "Na", "]"}], "*", 
  RowBox[{"Norm", "[", "Na", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"R1", "=", 
   RowBox[{
    RowBox[{"Norm", "[", "Na", "]"}], "*", 
    RowBox[{"Norm", "[", "Na", "]"}], "*", "Em"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R2", "=", 
   RowBox[{
    RowBox[{"Norm", "[", "Nm", "]"}], "*", 
    RowBox[{"Norm", "[", "Nm", "]"}], "*", "Em"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"M", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}], ";"}], " "}]}], "Input",
 CellChangeTimes->{{3.774704200805555*^9, 3.7747042008211546`*^9}, 
   3.774863314595379*^9, {3.7748648625080776`*^9, 3.7748648768601027`*^9}, {
   3.7748663456182632`*^9, 3.77486637220071*^9}, 3.7748664563628564`*^9, {
   3.774867438712169*^9, 3.774867440864973*^9}, {3.7751036357405663`*^9, 
   3.7751036623230124`*^9}, 
   3.7751067076097417`*^9},ExpressionUUID->"53c6153d-d232-4c71-aac5-\
4c7be1a31308"],

Cell[BoxData["0.0017945494561880198`"], "Output",
 CellChangeTimes->{3.775106708678803*^9, 
  3.775136619515201*^9},ExpressionUUID->"52e6393f-ac6d-4725-8572-\
bf689792c63a"],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{\\\"M\\\", \\\"\[LeftDoubleBracket]\
\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is longer than depth of \
object.\"",2,9,1,20214002460817327335,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.7748691827640104`*^9, 3.775033843706244*^9, 3.7750427715979786`*^9, 
   3.7751025441286626`*^9, {3.775103663305814*^9, 3.7751036653494177`*^9}, 
   3.775106708691804*^9, 
   3.7751366195308013`*^9},ExpressionUUID->"3504b344-60ca-4eef-a132-\
3d68afdb023d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"F", "=", 
   RowBox[{"RecurrenceTable", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"xp1", "[", "1", "]"}], "==", "0"}], ",", 
       RowBox[{
        RowBox[{"xp2", "[", "1", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"xp3", "[", "1", "]"}], "\[Equal]", "1"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xm1", "[", "1", "]"}], "==", "0"}], ",", 
       RowBox[{
        RowBox[{"xm2", "[", "1", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"xm3", "[", "1", "]"}], "\[Equal]", "1"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"wx", "[", "i", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "h"}], "*", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"xp3", "[", "i", "]"}], ",", 
                RowBox[{"-", 
                 RowBox[{"xp2", "[", "i", "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"xp3", "[", "i", "]"}]}], ",", "0", ",", 
                RowBox[{"xp1", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xp2", "[", "i", "]"}], ",", 
                RowBox[{"-", 
                 RowBox[{"xp1", "[", "i", "]"}]}], ",", "0"}], "}"}]}], "}"}],
             ".", "Ng"}]}], ")"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"wy", "[", "i", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "h"}], "*", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"xp3", "[", "i", "]"}], ",", 
                RowBox[{"-", 
                 RowBox[{"xp2", "[", "i", "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"xp3", "[", "i", "]"}]}], ",", "0", ",", 
                RowBox[{"xp1", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xp2", "[", "i", "]"}], ",", 
                RowBox[{"-", 
                 RowBox[{"xp1", "[", "i", "]"}]}], ",", "0"}], "}"}]}], "}"}],
             ".", "Ng"}]}], ")"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"wz", "[", "i", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "h"}], "*", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"xp3", "[", "i", "]"}], ",", 
                RowBox[{"-", 
                 RowBox[{"xp2", "[", "i", "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"xp3", "[", "i", "]"}]}], ",", "0", ",", 
                RowBox[{"xp1", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xp2", "[", "i", "]"}], ",", 
                RowBox[{"-", 
                 RowBox[{"xp1", "[", "i", "]"}]}], ",", "0"}], "}"}]}], "}"}],
             ".", "Ng"}]}], ")"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xm1", "[", 
         RowBox[{"i", "+", "1"}], "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "1", "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xp1", "[", "i", "]"}], ",", 
              RowBox[{"xp2", "[", "i", "]"}], ",", 
              RowBox[{"xp3", "[", "i", "]"}]}], "}"}]}], "+", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"wx", "[", "i", "]"}], ",", 
             RowBox[{"wy", "[", "i", "]"}], ",", 
             RowBox[{"wz", "[", "i", "]"}]}], "}"}]}], ")"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xm2", "[", 
         RowBox[{"i", "+", "1"}], "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "1", "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xp1", "[", "i", "]"}], ",", 
              RowBox[{"xp2", "[", "i", "]"}], ",", 
              RowBox[{"xp3", "[", "i", "]"}]}], "}"}]}], "+", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"wx", "[", "i", "]"}], ",", 
             RowBox[{"wy", "[", "i", "]"}], ",", 
             RowBox[{"wz", "[", "i", "]"}]}], "}"}]}], ")"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xm3", "[", 
         RowBox[{"i", "+", "1"}], "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "1", "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xp1", "[", "i", "]"}], ",", 
              RowBox[{"xp2", "[", "i", "]"}], ",", 
              RowBox[{"xp3", "[", "i", "]"}]}], "}"}]}], "+", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"wx", "[", "i", "]"}], ",", 
             RowBox[{"wy", "[", "i", "]"}], ",", 
             RowBox[{"wz", "[", "i", "]"}]}], "}"}]}], ")"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q11", "[", "i", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"h", "*", "h", "*", 
           RowBox[{"Norm", "[", "Ng", "]"}], "*", 
           RowBox[{"Norm", "[", "Ng", "]"}], 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"xp3", "[", "i", "]"}], ",", 
                RowBox[{"-", 
                 RowBox[{"xp2", "[", "i", "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"xp3", "[", "i", "]"}]}], ",", "0", ",", 
                RowBox[{"xp1", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xp2", "[", "i", "]"}], ",", 
                RowBox[{"-", 
                 RowBox[{"xp1", "[", "i", "]"}]}], ",", "0"}], "}"}]}], "}"}],
             ".", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"xp3", "[", "i", "]"}], ",", 
                 RowBox[{"-", 
                  RowBox[{"xp2", "[", "i", "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"xp3", "[", "i", "]"}]}], ",", "0", ",", 
                 RowBox[{"xp1", "[", "i", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xp2", "[", "i", "]"}], ",", 
                 RowBox[{"-", 
                  RowBox[{"xp1", "[", "i", "]"}]}], ",", "0"}], "}"}]}], 
              "}"}], "]"}]}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q12", "[", "i", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"h", "*", "h", "*", 
           RowBox[{"Norm", "[", "Ng", "]"}], "*", 
           RowBox[{"Norm", "[", "Ng", "]"}], 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"xp3", "[", "i", "]"}], ",", 
                RowBox[{"-", 
                 RowBox[{"xp2", "[", "i", "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"xp3", "[", "i", "]"}]}], ",", "0", ",", 
                RowBox[{"xp1", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xp2", "[", "i", "]"}], ",", 
                RowBox[{"-", 
                 RowBox[{"xp1", "[", "i", "]"}]}], ",", "0"}], "}"}]}], "}"}],
             ".", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"xp3", "[", "i", "]"}], ",", 
                 RowBox[{"-", 
                  RowBox[{"xp2", "[", "i", "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"xp3", "[", "i", "]"}]}], ",", "0", ",", 
                 RowBox[{"xp1", "[", "i", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xp2", "[", "i", "]"}], ",", 
                 RowBox[{"-", 
                  RowBox[{"xp1", "[", "i", "]"}]}], ",", "0"}], "}"}]}], 
              "}"}], "]"}]}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q13", "[", "i", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"h", "*", "h", "*", 
           RowBox[{"Norm", "[", "Ng", "]"}], "*", 
           RowBox[{"Norm", "[", "Ng", "]"}], 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"xp3", "[", "i", "]"}], ",", 
                RowBox[{"-", 
                 RowBox[{"xp2", "[", "i", "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"xp3", "[", "i", "]"}]}], ",", "0", ",", 
                RowBox[{"xp1", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xp2", "[", "i", "]"}], ",", 
                RowBox[{"-", 
                 RowBox[{"xp1", "[", "i", "]"}]}], ",", "0"}], "}"}]}], "}"}],
             ".", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"xp3", "[", "i", "]"}], ",", 
                 RowBox[{"-", 
                  RowBox[{"xp2", "[", "i", "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"xp3", "[", "i", "]"}]}], ",", "0", ",", 
                 RowBox[{"xp1", "[", "i", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xp2", "[", "i", "]"}], ",", 
                 RowBox[{"-", 
                  RowBox[{"xp1", "[", "i", "]"}]}], ",", "0"}], "}"}]}], 
              "}"}], "]"}]}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q21", "[", "i", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"h", "*", "h", "*", 
           RowBox[{"Norm", "[", "Ng", "]"}], "*", 
           RowBox[{"Norm", "[", "Ng", "]"}], 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"xp3", "[", "i", "]"}], ",", 
                RowBox[{"-", 
                 RowBox[{"xp2", "[", "i", "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"xp3", "[", "i", "]"}]}], ",", "0", ",", 
                RowBox[{"xp1", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xp2", "[", "i", "]"}], ",", 
                RowBox[{"-", 
                 RowBox[{"xp1", "[", "i", "]"}]}], ",", "0"}], "}"}]}], "}"}],
             ".", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"xp3", "[", "i", "]"}], ",", 
                 RowBox[{"-", 
                  RowBox[{"xp2", "[", "i", "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"xp3", "[", "i", "]"}]}], ",", "0", ",", 
                 RowBox[{"xp1", "[", "i", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xp2", "[", "i", "]"}], ",", 
                 RowBox[{"-", 
                  RowBox[{"xp1", "[", "i", "]"}]}], ",", "0"}], "}"}]}], 
              "}"}], "]"}]}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q22", "[", "i", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"h", "*", "h", "*", 
           RowBox[{"Norm", "[", "Ng", "]"}], "*", 
           RowBox[{"Norm", "[", "Ng", "]"}], 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"xp3", "[", "i", "]"}], ",", 
                RowBox[{"-", 
                 RowBox[{"xp2", "[", "i", "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"xp3", "[", "i", "]"}]}], ",", "0", ",", 
                RowBox[{"xp1", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xp2", "[", "i", "]"}], ",", 
                RowBox[{"-", 
                 RowBox[{"xp1", "[", "i", "]"}]}], ",", "0"}], "}"}]}], "}"}],
             ".", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"xp3", "[", "i", "]"}], ",", 
                 RowBox[{"-", 
                  RowBox[{"xp2", "[", "i", "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"xp3", "[", "i", "]"}]}], ",", "0", ",", 
                 RowBox[{"xp1", "[", "i", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xp2", "[", "i", "]"}], ",", 
                 RowBox[{"-", 
                  RowBox[{"xp1", "[", "i", "]"}]}], ",", "0"}], "}"}]}], 
              "}"}], "]"}]}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q23", "[", "i", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"h", "*", "h", "*", 
           RowBox[{"Norm", "[", "Ng", "]"}], "*", 
           RowBox[{"Norm", "[", "Ng", "]"}], 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"xp3", "[", "i", "]"}], ",", 
                RowBox[{"-", 
                 RowBox[{"xp2", "[", "i", "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"xp3", "[", "i", "]"}]}], ",", "0", ",", 
                RowBox[{"xp1", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xp2", "[", "i", "]"}], ",", 
                RowBox[{"-", 
                 RowBox[{"xp1", "[", "i", "]"}]}], ",", "0"}], "}"}]}], "}"}],
             ".", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"xp3", "[", "i", "]"}], ",", 
                 RowBox[{"-", 
                  RowBox[{"xp2", "[", "i", "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"xp3", "[", "i", "]"}]}], ",", "0", ",", 
                 RowBox[{"xp1", "[", "i", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xp2", "[", "i", "]"}], ",", 
                 RowBox[{"-", 
                  RowBox[{"xp1", "[", "i", "]"}]}], ",", "0"}], "}"}]}], 
              "}"}], "]"}]}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q31", "[", "i", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"h", "*", "h", "*", 
           RowBox[{"Norm", "[", "Ng", "]"}], "*", 
           RowBox[{"Norm", "[", "Ng", "]"}], 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"xp3", "[", "i", "]"}], ",", 
                RowBox[{"-", 
                 RowBox[{"xp2", "[", "i", "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"xp3", "[", "i", "]"}]}], ",", "0", ",", 
                RowBox[{"xp1", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xp2", "[", "i", "]"}], ",", 
                RowBox[{"-", 
                 RowBox[{"xp1", "[", "i", "]"}]}], ",", "0"}], "}"}]}], "}"}],
             ".", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"xp3", "[", "i", "]"}], ",", 
                 RowBox[{"-", 
                  RowBox[{"xp2", "[", "i", "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"xp3", "[", "i", "]"}]}], ",", "0", ",", 
                 RowBox[{"xp1", "[", "i", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xp2", "[", "i", "]"}], ",", 
                 RowBox[{"-", 
                  RowBox[{"xp1", "[", "i", "]"}]}], ",", "0"}], "}"}]}], 
              "}"}], "]"}]}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q32", "[", "i", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"h", "*", "h", "*", 
           RowBox[{"Norm", "[", "Ng", "]"}], "*", 
           RowBox[{"Norm", "[", "Ng", "]"}], 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"xp3", "[", "i", "]"}], ",", 
                RowBox[{"-", 
                 RowBox[{"xp2", "[", "i", "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"xp3", "[", "i", "]"}]}], ",", "0", ",", 
                RowBox[{"xp1", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xp2", "[", "i", "]"}], ",", 
                RowBox[{"-", 
                 RowBox[{"xp1", "[", "i", "]"}]}], ",", "0"}], "}"}]}], "}"}],
             ".", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"xp3", "[", "i", "]"}], ",", 
                 RowBox[{"-", 
                  RowBox[{"xp2", "[", "i", "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"xp3", "[", "i", "]"}]}], ",", "0", ",", 
                 RowBox[{"xp1", "[", "i", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xp2", "[", "i", "]"}], ",", 
                 RowBox[{"-", 
                  RowBox[{"xp1", "[", "i", "]"}]}], ",", "0"}], "}"}]}], 
              "}"}], "]"}]}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q33", "[", "i", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"h", "*", "h", "*", 
           RowBox[{"Norm", "[", "Ng", "]"}], "*", 
           RowBox[{"Norm", "[", "Ng", "]"}], 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"xp3", "[", "i", "]"}], ",", 
                RowBox[{"-", 
                 RowBox[{"xp2", "[", "i", "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"xp3", "[", "i", "]"}]}], ",", "0", ",", 
                RowBox[{"xp1", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xp2", "[", "i", "]"}], ",", 
                RowBox[{"-", 
                 RowBox[{"xp1", "[", "i", "]"}]}], ",", "0"}], "}"}]}], "}"}],
             ".", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"xp3", "[", "i", "]"}], ",", 
                 RowBox[{"-", 
                  RowBox[{"xp2", "[", "i", "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"xp3", "[", "i", "]"}]}], ",", "0", ",", 
                 RowBox[{"xp1", "[", "i", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xp2", "[", "i", "]"}], ",", 
                 RowBox[{"-", 
                  RowBox[{"xp1", "[", "i", "]"}]}], ",", "0"}], "}"}]}], 
              "}"}], "]"}]}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p11", "[", "1", "]"}], "==", 
        RowBox[{"10", "*", 
         RowBox[{"Em", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p12", "[", "1", "]"}], "==", 
        RowBox[{"10", "*", 
         RowBox[{"Em", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p13", "[", "1", "]"}], "==", 
        RowBox[{"10", "*", 
         RowBox[{"Em", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "3"}], "]"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p21", "[", "1", "]"}], "==", 
        RowBox[{"10", "*", 
         RowBox[{"Em", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p22", "[", "1", "]"}], "==", 
        RowBox[{"10", "*", 
         RowBox[{"Em", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p23", "[", "1", "]"}], "==", 
        RowBox[{"10", "*", 
         RowBox[{"Em", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "3"}], "]"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p31", "[", "1", "]"}], "==", 
        RowBox[{"10", "*", 
         RowBox[{"Em", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p32", "[", "1", "]"}], "==", 
        RowBox[{"10", "*", 
         RowBox[{"Em", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "2"}], "]"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p33", "[", "1", "]"}], "==", 
        RowBox[{"10", "*", 
         RowBox[{"Em", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pm11", "[", 
         RowBox[{"i", "+", "1"}], "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "i", "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"p11", "[", "i", "]"}], ",", 
                RowBox[{"p12", "[", "i", "]"}], ",", 
                RowBox[{"p13", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"p21", "[", "i", "]"}], ",", 
                RowBox[{"p22", "[", "i", "]"}], ",", 
                RowBox[{"p23", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"p31", "[", "i", "]"}], ",", 
                RowBox[{"p32", "[", "i", "]"}], ",", 
                RowBox[{"p33", "[", "i", "]"}]}], "}"}]}], "}"}], ".", 
            RowBox[{"Transpose", "[", 
             RowBox[{"A", "[", "i", "]"}], "]"}]}], "+", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"q11", "[", "i", "]"}], ",", 
               RowBox[{"q12", "[", "i", "]"}], ",", 
               RowBox[{"q13", "[", "i", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"q21", "[", "i", "]"}], ",", 
               RowBox[{"q22", "[", "i", "]"}], ",", 
               RowBox[{"q23", "[", "i", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"q31", "[", "i", "]"}], ",", 
               RowBox[{"q32", "[", "i", "]"}], ",", 
               RowBox[{"q33", "[", "i", "]"}]}], "}"}]}], "}"}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pm12", "[", 
         RowBox[{"i", "+", "1"}], "]"}], "==", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "i", "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"p11", "[", "i", "]"}], ",", 
                RowBox[{"p12", "[", "i", "]"}], ",", 
                RowBox[{"p13", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"p21", "[", "i", "]"}], ",", 
                RowBox[{"p22", "[", "i", "]"}], ",", 
                RowBox[{"p23", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"p31", "[", "i", "]"}], ",", 
                RowBox[{"p32", "[", "i", "]"}], ",", 
                RowBox[{"p33", "[", "i", "]"}]}], "}"}]}], "}"}], ".", 
            RowBox[{"Transpose", "[", 
             RowBox[{"A", "[", "i", "]"}], "]"}]}], "+", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"q11", "[", "i", "]"}], ",", 
               RowBox[{"q12", "[", "i", "]"}], ",", 
               RowBox[{"q13", "[", "i", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"q21", "[", "i", "]"}], ",", 
               RowBox[{"q22", "[", "i", "]"}], ",", 
               RowBox[{"q23", "[", "i", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"q31", "[", "i", "]"}], ",", 
               RowBox[{"q32", "[", "i", "]"}], ",", 
               RowBox[{"q33", "[", "i", "]"}]}], "}"}]}], "}"}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pm13", "[", 
         RowBox[{"i", "+", "1"}], "]"}], "==", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "i", "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"p11", "[", "i", "]"}], ",", 
                RowBox[{"p12", "[", "i", "]"}], ",", 
                RowBox[{"p13", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"p21", "[", "i", "]"}], ",", 
                RowBox[{"p22", "[", "i", "]"}], ",", 
                RowBox[{"p23", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"p31", "[", "i", "]"}], ",", 
                RowBox[{"p32", "[", "i", "]"}], ",", 
                RowBox[{"p33", "[", "i", "]"}]}], "}"}]}], "}"}], ".", 
            RowBox[{"Transpose", "[", 
             RowBox[{"A", "[", "i", "]"}], "]"}]}], "+", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"q11", "[", "i", "]"}], ",", 
               RowBox[{"q12", "[", "i", "]"}], ",", 
               RowBox[{"q13", "[", "i", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"q21", "[", "i", "]"}], ",", 
               RowBox[{"q22", "[", "i", "]"}], ",", 
               RowBox[{"q23", "[", "i", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"q31", "[", "i", "]"}], ",", 
               RowBox[{"q32", "[", "i", "]"}], ",", 
               RowBox[{"q33", "[", "i", "]"}]}], "}"}]}], "}"}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pm21", "[", 
         RowBox[{"i", "+", "1"}], "]"}], "==", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "i", "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"p11", "[", "i", "]"}], ",", 
                RowBox[{"p12", "[", "i", "]"}], ",", 
                RowBox[{"p13", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"p21", "[", "i", "]"}], ",", 
                RowBox[{"p22", "[", "i", "]"}], ",", 
                RowBox[{"p23", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"p31", "[", "i", "]"}], ",", 
                RowBox[{"p32", "[", "i", "]"}], ",", 
                RowBox[{"p33", "[", "i", "]"}]}], "}"}]}], "}"}], ".", 
            RowBox[{"Transpose", "[", 
             RowBox[{"A", "[", "i", "]"}], "]"}]}], "+", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"q11", "[", "i", "]"}], ",", 
               RowBox[{"q12", "[", "i", "]"}], ",", 
               RowBox[{"q13", "[", "i", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"q21", "[", "i", "]"}], ",", 
               RowBox[{"q22", "[", "i", "]"}], ",", 
               RowBox[{"q23", "[", "i", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"q31", "[", "i", "]"}], ",", 
               RowBox[{"q32", "[", "i", "]"}], ",", 
               RowBox[{"q33", "[", "i", "]"}]}], "}"}]}], "}"}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pm22", "[", 
         RowBox[{"i", "+", "1"}], "]"}], "==", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "i", "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"p11", "[", "i", "]"}], ",", 
                RowBox[{"p12", "[", "i", "]"}], ",", 
                RowBox[{"p13", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"p21", "[", "i", "]"}], ",", 
                RowBox[{"p22", "[", "i", "]"}], ",", 
                RowBox[{"p23", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"p31", "[", "i", "]"}], ",", 
                RowBox[{"p32", "[", "i", "]"}], ",", 
                RowBox[{"p33", "[", "i", "]"}]}], "}"}]}], "}"}], ".", 
            RowBox[{"Transpose", "[", 
             RowBox[{"A", "[", "i", "]"}], "]"}]}], "+", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"q11", "[", "i", "]"}], ",", 
               RowBox[{"q12", "[", "i", "]"}], ",", 
               RowBox[{"q13", "[", "i", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"q21", "[", "i", "]"}], ",", 
               RowBox[{"q22", "[", "i", "]"}], ",", 
               RowBox[{"q23", "[", "i", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"q31", "[", "i", "]"}], ",", 
               RowBox[{"q32", "[", "i", "]"}], ",", 
               RowBox[{"q33", "[", "i", "]"}]}], "}"}]}], "}"}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pm23", "[", 
         RowBox[{"i", "+", "1"}], "]"}], "==", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "i", "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"p11", "[", "i", "]"}], ",", 
                RowBox[{"p12", "[", "i", "]"}], ",", 
                RowBox[{"p13", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"p21", "[", "i", "]"}], ",", 
                RowBox[{"p22", "[", "i", "]"}], ",", 
                RowBox[{"p23", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"p31", "[", "i", "]"}], ",", 
                RowBox[{"p32", "[", "i", "]"}], ",", 
                RowBox[{"p33", "[", "i", "]"}]}], "}"}]}], "}"}], ".", 
            RowBox[{"Transpose", "[", 
             RowBox[{"A", "[", "i", "]"}], "]"}]}], "+", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"q11", "[", "i", "]"}], ",", 
               RowBox[{"q12", "[", "i", "]"}], ",", 
               RowBox[{"q13", "[", "i", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"q21", "[", "i", "]"}], ",", 
               RowBox[{"q22", "[", "i", "]"}], ",", 
               RowBox[{"q23", "[", "i", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"q31", "[", "i", "]"}], ",", 
               RowBox[{"q32", "[", "i", "]"}], ",", 
               RowBox[{"q33", "[", "i", "]"}]}], "}"}]}], "}"}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pm31", "[", 
         RowBox[{"i", "+", "1"}], "]"}], "==", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "i", "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"p11", "[", "i", "]"}], ",", 
                RowBox[{"p12", "[", "i", "]"}], ",", 
                RowBox[{"p13", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"p21", "[", "i", "]"}], ",", 
                RowBox[{"p22", "[", "i", "]"}], ",", 
                RowBox[{"p23", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"p31", "[", "i", "]"}], ",", 
                RowBox[{"p32", "[", "i", "]"}], ",", 
                RowBox[{"p33", "[", "i", "]"}]}], "}"}]}], "}"}], ".", 
            RowBox[{"Transpose", "[", 
             RowBox[{"A", "[", "i", "]"}], "]"}]}], "+", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"q11", "[", "i", "]"}], ",", 
               RowBox[{"q12", "[", "i", "]"}], ",", 
               RowBox[{"q13", "[", "i", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"q21", "[", "i", "]"}], ",", 
               RowBox[{"q22", "[", "i", "]"}], ",", 
               RowBox[{"q23", "[", "i", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"q31", "[", "i", "]"}], ",", 
               RowBox[{"q32", "[", "i", "]"}], ",", 
               RowBox[{"q33", "[", "i", "]"}]}], "}"}]}], "}"}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pm32", "[", 
         RowBox[{"i", "+", "1"}], "]"}], "==", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "i", "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"p11", "[", "i", "]"}], ",", 
                RowBox[{"p12", "[", "i", "]"}], ",", 
                RowBox[{"p13", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"p21", "[", "i", "]"}], ",", 
                RowBox[{"p22", "[", "i", "]"}], ",", 
                RowBox[{"p23", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"p31", "[", "i", "]"}], ",", 
                RowBox[{"p32", "[", "i", "]"}], ",", 
                RowBox[{"p33", "[", "i", "]"}]}], "}"}]}], "}"}], ".", 
            RowBox[{"Transpose", "[", 
             RowBox[{"A", "[", "i", "]"}], "]"}]}], "+", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"q11", "[", "i", "]"}], ",", 
               RowBox[{"q12", "[", "i", "]"}], ",", 
               RowBox[{"q13", "[", "i", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"q21", "[", "i", "]"}], ",", 
               RowBox[{"q22", "[", "i", "]"}], ",", 
               RowBox[{"q23", "[", "i", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"q31", "[", "i", "]"}], ",", 
               RowBox[{"q32", "[", "i", "]"}], ",", 
               RowBox[{"q33", "[", "i", "]"}]}], "}"}]}], "}"}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pm33", "[", 
         RowBox[{"i", "+", "1"}], "]"}], "==", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "i", "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"p11", "[", "i", "]"}], ",", 
                RowBox[{"p12", "[", "i", "]"}], ",", 
                RowBox[{"p13", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"p21", "[", "i", "]"}], ",", 
                RowBox[{"p22", "[", "i", "]"}], ",", 
                RowBox[{"p23", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"p31", "[", "i", "]"}], ",", 
                RowBox[{"p32", "[", "i", "]"}], ",", 
                RowBox[{"p33", "[", "i", "]"}]}], "}"}]}], "}"}], ".", 
            RowBox[{"Transpose", "[", 
             RowBox[{"A", "[", "i", "]"}], "]"}]}], "+", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"q11", "[", "i", "]"}], ",", 
               RowBox[{"q12", "[", "i", "]"}], ",", 
               RowBox[{"q13", "[", "i", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"q21", "[", "i", "]"}], ",", 
               RowBox[{"q22", "[", "i", "]"}], ",", 
               RowBox[{"q23", "[", "i", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"q31", "[", "i", "]"}], ",", 
               RowBox[{"q32", "[", "i", "]"}], ",", 
               RowBox[{"q33", "[", "i", "]"}]}], "}"}]}], "}"}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"k11", "[", 
         RowBox[{"i", "+", "1"}], "]"}], "==", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm11", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm12", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm13", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm21", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm22", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm23", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm31", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm32", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm33", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}], ".", 
           RowBox[{"Inverse", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pm11", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm12", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm13", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pm21", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm22", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm23", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pm31", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm32", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm33", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}], "+", 
             "R1"}], "]"}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"k12", "[", 
         RowBox[{"i", "+", "1"}], "]"}], "==", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm11", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm12", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm13", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm21", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm22", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm23", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm31", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm32", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm33", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}], ".", 
           RowBox[{"Inverse", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pm11", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm12", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm13", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pm21", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm22", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm23", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pm31", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm32", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm33", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}], "+", 
             "R1"}], "]"}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"k13", "[", 
         RowBox[{"i", "+", "1"}], "]"}], "==", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm11", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm12", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm13", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm21", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm22", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm23", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm31", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm32", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm33", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}], ".", 
           RowBox[{"Inverse", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pm11", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm12", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm13", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pm21", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm22", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm23", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pm31", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm32", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm33", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}], "+", 
             "R1"}], "]"}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"k21", "[", 
         RowBox[{"i", "+", "1"}], "]"}], "==", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm11", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm12", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm13", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm21", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm22", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm23", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm31", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm32", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm33", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}], ".", 
           RowBox[{"Inverse", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pm11", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm12", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm13", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pm21", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm22", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm23", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pm31", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm32", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm33", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}], "+", 
             "R1"}], "]"}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"k22", "[", 
         RowBox[{"i", "+", "1"}], "]"}], "==", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm11", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm12", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm13", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm21", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm22", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm23", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm31", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm32", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm33", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}], ".", 
           RowBox[{"Inverse", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pm11", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm12", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm13", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pm21", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm22", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm23", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pm31", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm32", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm33", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}], "+", 
             "R1"}], "]"}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"k23", "[", 
         RowBox[{"i", "+", "1"}], "]"}], "==", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm11", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm12", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm13", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm21", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm22", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm23", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm31", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm32", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm33", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}], ".", 
           RowBox[{"Inverse", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pm11", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm12", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm13", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pm21", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm22", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm23", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pm31", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm32", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm33", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}], "+", 
             "R1"}], "]"}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"k31", "[", 
         RowBox[{"i", "+", "1"}], "]"}], "==", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm11", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm12", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm13", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm21", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm22", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm23", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm31", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm32", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm33", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}], ".", 
           RowBox[{"Inverse", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pm11", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm12", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm13", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pm21", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm22", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm23", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pm31", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm32", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm33", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}], "+", 
             "R1"}], "]"}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"k32", "[", 
         RowBox[{"i", "+", "1"}], "]"}], "==", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm11", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm12", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm13", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm21", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm22", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm23", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm31", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm32", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm33", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}], ".", 
           RowBox[{"Inverse", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pm11", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm12", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm13", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pm21", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm22", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm23", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pm31", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm32", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm33", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}], "+", 
             "R1"}], "]"}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"k33", "[", 
         RowBox[{"i", "+", "1"}], "]"}], "==", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm11", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm12", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm13", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm21", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm22", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm23", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm31", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm32", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm33", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}], ".", 
           RowBox[{"Inverse", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pm11", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm12", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm13", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pm21", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm22", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm23", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pm31", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm32", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"pm33", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}], "+", 
             "R1"}], "]"}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"k11", "[", "1", "]"}], "==", "1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"k12", "[", "1", "]"}], "\[Equal]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"k13", "[", "1", "]"}], "\[Equal]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"k21", "[", "1", "]"}], "\[Equal]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"k22", "[", "1", "]"}], "\[Equal]", "1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"k23", "[", "1", "]"}], "\[Equal]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"k31", "[", "1", "]"}], "\[Equal]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"k32", "[", "1", "]"}], "\[Equal]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"k33", "[", "1", "]"}], "\[Equal]", "1"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xp1", "[", 
         RowBox[{"i", "+", "1"}], "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"xm1", "[", 
              RowBox[{"i", "+", "1"}], "]"}], ",", 
             RowBox[{"xm2", "[", 
              RowBox[{"i", "+", "1"}], "]"}], ",", 
             RowBox[{"xm3", "[", 
              RowBox[{"i", "+", "1"}], "]"}]}], "}"}], "+", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"k11", "[", 
                 RowBox[{"i", "+", "1"}], "]"}], ",", 
                RowBox[{"k12", "[", 
                 RowBox[{"i", "+", "1"}], "]"}], ",", 
                RowBox[{"k13", "[", 
                 RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"k21", "[", 
                 RowBox[{"i", "+", "1"}], "]"}], ",", 
                RowBox[{"k22", "[", 
                 RowBox[{"i", "+", "1"}], "]"}], ",", 
                RowBox[{"k23", "[", 
                 RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"k31", "[", 
                 RowBox[{"i", "+", "1"}], "]"}], ",", 
                RowBox[{"k32", "[", 
                 RowBox[{"i", "+", "1"}], "]"}], ",", 
                RowBox[{"k33", "[", 
                 RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}], ".", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"NewAksel", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "-", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xm1", "[", 
                 RowBox[{"i", "+", "1"}], "]"}], ",", 
                RowBox[{"xm2", "[", 
                 RowBox[{"i", "+", "1"}], "]"}], ",", 
                RowBox[{"xm3", "[", 
                 RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], ")"}]}]}], ")"}], 
         "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xp2", "[", 
         RowBox[{"i", "+", "1"}], "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"xm1", "[", 
              RowBox[{"i", "+", "1"}], "]"}], ",", 
             RowBox[{"xm2", "[", 
              RowBox[{"i", "+", "1"}], "]"}], ",", 
             RowBox[{"xm3", "[", 
              RowBox[{"i", "+", "1"}], "]"}]}], "}"}], "+", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"k11", "[", 
                 RowBox[{"i", "+", "1"}], "]"}], ",", 
                RowBox[{"k12", "[", 
                 RowBox[{"i", "+", "1"}], "]"}], ",", 
                RowBox[{"k13", "[", 
                 RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"k21", "[", 
                 RowBox[{"i", "+", "1"}], "]"}], ",", 
                RowBox[{"k22", "[", 
                 RowBox[{"i", "+", "1"}], "]"}], ",", 
                RowBox[{"k23", "[", 
                 RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"k31", "[", 
                 RowBox[{"i", "+", "1"}], "]"}], ",", 
                RowBox[{"k32", "[", 
                 RowBox[{"i", "+", "1"}], "]"}], ",", 
                RowBox[{"k33", "[", 
                 RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}], ".", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"NewAksel", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "-", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xm1", "[", 
                 RowBox[{"i", "+", "1"}], "]"}], ",", 
                RowBox[{"xm2", "[", 
                 RowBox[{"i", "+", "1"}], "]"}], ",", 
                RowBox[{"xm3", "[", 
                 RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], ")"}]}]}], ")"}], 
         "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xp3", "[", 
         RowBox[{"i", "+", "1"}], "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"xm1", "[", 
              RowBox[{"i", "+", "1"}], "]"}], ",", 
             RowBox[{"xm2", "[", 
              RowBox[{"i", "+", "1"}], "]"}], ",", 
             RowBox[{"xm3", "[", 
              RowBox[{"i", "+", "1"}], "]"}]}], "}"}], "+", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"k11", "[", 
                 RowBox[{"i", "+", "1"}], "]"}], ",", 
                RowBox[{"k12", "[", 
                 RowBox[{"i", "+", "1"}], "]"}], ",", 
                RowBox[{"k13", "[", 
                 RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"k21", "[", 
                 RowBox[{"i", "+", "1"}], "]"}], ",", 
                RowBox[{"k22", "[", 
                 RowBox[{"i", "+", "1"}], "]"}], ",", 
                RowBox[{"k23", "[", 
                 RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"k31", "[", 
                 RowBox[{"i", "+", "1"}], "]"}], ",", 
                RowBox[{"k32", "[", 
                 RowBox[{"i", "+", "1"}], "]"}], ",", 
                RowBox[{"k33", "[", 
                 RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}], ".", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"NewAksel", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "-", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xm1", "[", 
                 RowBox[{"i", "+", "1"}], "]"}], ",", 
                RowBox[{"xm2", "[", 
                 RowBox[{"i", "+", "1"}], "]"}], ",", 
                RowBox[{"xm3", "[", 
                 RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], ")"}]}]}], ")"}], 
         "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p11", "[", 
         RowBox[{"i", "+", "1"}], "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Em", "-", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"k11", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k12", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k13", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"k21", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k22", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k23", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"k31", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k32", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k33", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}]}], ")"}], 
           ".", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm11", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm12", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm13", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm21", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm22", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm23", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm31", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm32", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm33", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}]}], ")"}], 
         "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p12", "[", 
         RowBox[{"i", "+", "1"}], "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Em", "-", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"k11", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k12", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k13", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"k21", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k22", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k23", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"k31", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k32", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k33", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}]}], ")"}], 
           ".", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm11", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm12", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm13", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm21", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm22", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm23", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm31", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm32", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm33", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}]}], ")"}], 
         "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p13", "[", 
         RowBox[{"i", "+", "1"}], "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Em", "-", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"k11", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k12", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k13", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"k21", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k22", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k23", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"k31", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k32", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k33", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}]}], ")"}], 
           ".", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm11", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm12", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm13", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm21", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm22", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm23", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm31", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm32", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm33", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}]}], ")"}], 
         "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p21", "[", 
         RowBox[{"i", "+", "1"}], "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Em", "-", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"k11", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k12", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k13", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"k21", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k22", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k23", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"k31", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k32", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k33", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}]}], ")"}], 
           ".", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm11", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm12", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm13", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm21", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm22", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm23", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm31", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm32", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm33", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}]}], ")"}], 
         "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p22", "[", 
         RowBox[{"i", "+", "1"}], "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Em", "-", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"k11", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k12", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k13", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"k21", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k22", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k23", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"k31", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k32", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k33", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}]}], ")"}], 
           ".", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm11", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm12", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm13", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm21", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm22", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm23", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm31", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm32", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm33", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}]}], ")"}], 
         "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p23", "[", 
         RowBox[{"i", "+", "1"}], "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Em", "-", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"k11", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k12", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k13", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"k21", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k22", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k23", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"k31", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k32", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k33", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}]}], ")"}], 
           ".", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm11", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm12", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm13", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm21", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm22", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm23", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm31", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm32", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm33", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}]}], ")"}], 
         "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p31", "[", 
         RowBox[{"i", "+", "1"}], "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Em", "-", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"k11", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k12", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k13", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"k21", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k22", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k23", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"k31", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k32", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k33", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}]}], ")"}], 
           ".", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm11", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm12", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm13", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm21", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm22", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm23", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm31", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm32", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm33", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}]}], ")"}], 
         "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p32", "[", 
         RowBox[{"i", "+", "1"}], "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Em", "-", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"k11", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k12", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k13", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"k21", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k22", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k23", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"k31", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k32", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k33", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}]}], ")"}], 
           ".", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm11", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm12", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm13", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm21", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm22", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm23", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm31", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm32", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm33", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}]}], ")"}], 
         "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p33", "[", 
         RowBox[{"i", "+", "1"}], "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Em", "-", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"k11", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k12", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k13", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"k21", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k22", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k23", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"k31", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k32", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"k33", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}]}], ")"}], 
           ".", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm11", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm12", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm13", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm21", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm22", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm23", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pm31", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm32", "[", 
                RowBox[{"i", "+", "1"}], "]"}], ",", 
               RowBox[{"pm33", "[", 
                RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}]}], ")"}], 
         "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"gamma", "[", "i", "]"}], "\[Equal]", 
        RowBox[{"ArcTan", "[", 
         RowBox[{
          RowBox[{"xp2", "[", "i", "]"}], "/", 
          RowBox[{"xp3", "[", "i", "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"beta", "[", "i", "]"}], "\[Equal]", 
        RowBox[{"ArcTan", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"xp1", "[", "i", "]"}]}], "*", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"gamma", "[", "i", "]"}], "]"}], "/", 
           RowBox[{"xp2", "[", "i", "]"}]}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "xm1", ",", "xm2", ",", "xm3", ",", "xp1", ",", "xp2", ",", "xp3", ",", 
       "q11", ",", "q12", ",", "q13", ",", "q21", ",", "q22", ",", "q23", ",",
        "q31", ",", "q32", ",", "q33", ",", "pm11", ",", "pm12", ",", "pm13", 
       ",", "pm21", ",", "pm22", ",", "pm23", ",", "pm31", ",", "pm32", ",", 
       "pm33", ",", "p11", ",", "p12", ",", "p13", ",", "p21", ",", "p22", 
       ",", "p23", ",", "p31", ",", "p32", ",", "p33", ",", "k11", ",", "k12",
        ",", "k13", ",", "k21", ",", "k22", ",", "k23", ",", "k31", ",", 
       "k32", ",", "k33", ",", "wx", ",", "wy", ",", "wz", ",", "gamma", ",", 
       "beta"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"M", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.774704115847807*^9, 3.7747042286828036`*^9}, {
   3.7747051600824275`*^9, 3.7747052927138586`*^9}, {3.774705494734211*^9, 
   3.774705580674761*^9}, {3.774705661108501*^9, 3.7747057152873955`*^9}, {
   3.774859467623351*^9, 3.7748594692015576`*^9}, {3.774859786325912*^9, 
   3.77485979941265*^9}, {3.7748598306573935`*^9, 3.774859849132563*^9}, {
   3.774859879155879*^9, 3.7748598850123377`*^9}, {3.7748599363150873`*^9, 
   3.774859965553979*^9}, {3.774860015575099*^9, 3.774860039616746*^9}, {
   3.774861531137869*^9, 3.7748616460632696`*^9}, {3.7748617398194327`*^9, 
   3.7748619084245267`*^9}, {3.7748619495773983`*^9, 
   3.7748620746584167`*^9}, {3.77486214562294*^9, 3.7748622274918833`*^9}, {
   3.774862281327577*^9, 3.774862327831258*^9}, {3.774862364397722*^9, 
   3.7748623814641514`*^9}, {3.7748624136938076`*^9, 3.774862538728026*^9}, {
   3.7748625868385096`*^9, 3.7748626939326963`*^9}, {3.774862733260365*^9, 
   3.774862786238057*^9}, {3.774862839028549*^9, 3.7748628484353657`*^9}, {
   3.774862971815981*^9, 3.7748629986012278`*^9}, 3.774863156177102*^9, {
   3.774863242273652*^9, 3.7748633973691225`*^9}, {3.7748634727016544`*^9, 
   3.7748635801858416`*^9}, {3.774863628655126*^9, 3.7748636473127584`*^9}, {
   3.774864939790612*^9, 3.7748649753118744`*^9}, {3.774865019974752*^9, 
   3.7748651671298084`*^9}, {3.7748652865948167`*^9, 3.774865297998437*^9}, {
   3.77486542585626*^9, 3.7748654261682606`*^9}, {3.7748654573371143`*^9, 
   3.774865609967781*^9}, {3.774865656627462*^9, 3.7748657233955784`*^9}, {
   3.7748657847192855`*^9, 3.774865957567587*^9}, {3.7748660026516657`*^9, 
   3.7748663105182023`*^9}, {3.774866465457672*^9, 3.7748664656292725`*^9}, {
   3.7748665980111036`*^9, 3.774866598229504*^9}, {3.7748666846848545`*^9, 
   3.774866684872055*^9}, {3.774867011162224*^9, 3.7748670115210247`*^9}, {
   3.7748675047470846`*^9, 3.7748675526079683`*^9}, {3.7748675862728267`*^9, 
   3.7748675865380273`*^9}, {3.7748676283304996`*^9, 3.7748676284553003`*^9}, 
   3.774867663305761*^9, {3.77486779457999*^9, 3.7748678068728113`*^9}, {
   3.774868117594153*^9, 3.7748681196221566`*^9}, {3.774868647683077*^9, 
   3.774868649820281*^9}, {3.774868724778412*^9, 
   3.774868726775215*^9}},ExpressionUUID->"e05c0e86-3643-4412-8e67-\
e5763794b586"],

Cell[BoxData[
 TemplateBox[{
  "Part","pkspec1",
   "\"The expression \\!\\(\\*RowBox[{\\\"i\\\"}]\\) cannot be used as a part \
specification.\"",2,26,2,20212246358474951042,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.774705717112599*^9, 3.77486637795712*^9, 
  3.774866472508885*^9, 3.774866606076318*^9, 3.774866708318896*^9, 
  3.774866943068105*^9, 3.774867013595828*^9, 3.7748676645537634`*^9, 
  3.774868131400177*^9, 
  3.7748687406436396`*^9},ExpressionUUID->"e704afe9-99f4-4a48-8def-\
33ed63291043"],

Cell[BoxData[
 TemplateBox[{
  "Part","pkspec1",
   "\"The expression \\!\\(\\*RowBox[{\\\"i\\\"}]\\) cannot be used as a part \
specification.\"",2,26,3,20212246358474951042,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.774705717112599*^9, 3.77486637795712*^9, 
  3.774866472508885*^9, 3.774866606076318*^9, 3.774866708318896*^9, 
  3.774866943068105*^9, 3.774867013595828*^9, 3.7748676645537634`*^9, 
  3.774868131400177*^9, 
  3.7748687406592393`*^9},ExpressionUUID->"c36beb4b-e1d8-4de1-a9c1-\
d2554ad0de47"],

Cell[BoxData[
 TemplateBox[{
  "Part","pkspec1",
   "\"The expression \\!\\(\\*RowBox[{\\\"i\\\"}]\\) cannot be used as a part \
specification.\"",2,26,4,20212246358474951042,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.774705717112599*^9, 3.77486637795712*^9, 
  3.774866472508885*^9, 3.774866606076318*^9, 3.774866708318896*^9, 
  3.774866943068105*^9, 3.774867013595828*^9, 3.7748676645537634`*^9, 
  3.774868131400177*^9, 
  3.7748687406748395`*^9},ExpressionUUID->"6f8ecfaf-e606-4596-8900-\
0b18a9fd7832"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"pkspec1\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,26,5,20212246358474951042,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.774705717112599*^9, 3.77486637795712*^9, 
  3.774866472508885*^9, 3.774866606076318*^9, 3.774866708318896*^9, 
  3.774866943068105*^9, 3.774867013595828*^9, 3.7748676645537634`*^9, 
  3.774868131400177*^9, 
  3.7748687406904397`*^9},ExpressionUUID->"66c3b05f-09c7-4bd2-9aa7-\
af1f7978a32f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"A", ";", " ", "B", ";"}], "\[IndentingNewLine]", 
   RowBox[{"J", ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"magx", "[", "i", "]"}], ",", 
      RowBox[{"magy", "[", "i", "]"}], ",", 
      RowBox[{"magz", "[", "i", "]"}]}], "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7748616547524843`*^9, 3.7748616562344875`*^9}, {
   3.774867017823436*^9, 3.7748670190870376`*^9}, {3.7748671861165285`*^9, 
   3.774867210078171*^9}, {3.774867658812953*^9, 3.774867680512591*^9}, {
   3.7748678265444455`*^9, 3.7748680313260026`*^9}, 3.774868125581367*^9, {
   3.775043827403973*^9, 3.77504389426569*^9}, {3.7750445842550297`*^9, 
   3.775044592866245*^9}, 3.775044640134327*^9, {3.7751007098709507`*^9, 
   3.775100719199767*^9}, {3.7751009050896907`*^9, 
   3.775100909239298*^9}},ExpressionUUID->"2a96bc4a-c463-47e5-a4cd-\
495a4a03a2c4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"magz", "[", "i", "]"}], " ", 
     RowBox[{"Sin", "[", "b", "]"}], " ", 
     RowBox[{"Sin", "[", "c", "]"}]}], "+", 
    RowBox[{
     RowBox[{"magy", "[", "i", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "c", "]"}], " ", 
        RowBox[{"Sin", "[", "a", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "a", "]"}], " ", 
        RowBox[{"Cos", "[", "b", "]"}], " ", 
        RowBox[{"Sin", "[", "c", "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"magx", "[", "i", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "a", "]"}], " ", 
        RowBox[{"Cos", "[", "c", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", "b", "]"}], " ", 
        RowBox[{"Sin", "[", "a", "]"}], " ", 
        RowBox[{"Sin", "[", "c", "]"}]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", "c", "]"}], " ", 
     RowBox[{"magz", "[", "i", "]"}], " ", 
     RowBox[{"Sin", "[", "b", "]"}]}], "+", 
    RowBox[{
     RowBox[{"magx", "[", "i", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", "b", "]"}]}], " ", 
        RowBox[{"Cos", "[", "c", "]"}], " ", 
        RowBox[{"Sin", "[", "a", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", "a", "]"}], " ", 
        RowBox[{"Sin", "[", "c", "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"magy", "[", "i", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "a", "]"}], " ", 
        RowBox[{"Cos", "[", "b", "]"}], " ", 
        RowBox[{"Cos", "[", "c", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Sin", "[", "a", "]"}], " ", 
        RowBox[{"Sin", "[", "c", "]"}]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", "b", "]"}], " ", 
     RowBox[{"magz", "[", "i", "]"}]}], "-", 
    RowBox[{
     RowBox[{"Cos", "[", "a", "]"}], " ", 
     RowBox[{"magy", "[", "i", "]"}], " ", 
     RowBox[{"Sin", "[", "b", "]"}]}], "+", 
    RowBox[{
     RowBox[{"magx", "[", "i", "]"}], " ", 
     RowBox[{"Sin", "[", "a", "]"}], " ", 
     RowBox[{"Sin", "[", "b", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.775043902315304*^9, 3.7750439395681686`*^9, 3.775044648854742*^9, {
   3.77510072086897*^9, 3.7751007302913857`*^9}, 
   3.7751009106121006`*^9},ExpressionUUID->"4bcb431c-28b9-4af7-844a-\
cfde43d6dde3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"P", ".", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"magx", "[", "0", "]"}], ",", 
    RowBox[{"magy", "[", "0", "]"}], ",", 
    RowBox[{"magz", "[", "0", "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{
  3.7748676464421315`*^9, {3.775044041139946*^9, 
   3.7750440766300077`*^9}},ExpressionUUID->"2869d549-090d-4548-9be6-\
8c2547eea00e"],

Cell[BoxData[
 RowBox[{"P", ".", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"magx", "[", "0", "]"}], ",", 
    RowBox[{"magy", "[", "0", "]"}], ",", 
    RowBox[{"magz", "[", "0", "]"}]}], "}"}]}]], "Output",
 CellChangeTimes->{3.775044047738757*^9, 3.775044080311614*^9, 
  3.7751007246753764`*^9},ExpressionUUID->"6a4e47c7-41e4-4b75-9647-\
6188914cbec8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"A", "=", 
     RowBox[{"ArcTan", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Aksel", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "/", 
       RowBox[{"Aksel", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"B", "=", 
     RowBox[{"ArcTan", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Aksel", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", "A", "]"}]}], "-", 
         RowBox[{
          RowBox[{"Aksel", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", "A", "]"}]}]}], ")"}], "/", 
       RowBox[{"Aksel", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "3"}], "]"}], "]"}]}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"P", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", "a", "]"}], ",", 
         RowBox[{"Sin", "[", "a", "]"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Cos", "[", "b", "]"}]}], "*", 
          RowBox[{"Sin", "[", "a", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Cos", "[", "b", "]"}], "*", 
          RowBox[{"Cos", "[", "a", "]"}]}], ",", 
         RowBox[{"Sin", "[", "b", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", "a", "]"}], "*", 
          RowBox[{"Sin", "[", "b", "]"}]}], ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Sin", "[", "b", "]"}]}], "*", 
          RowBox[{"Cos", "[", "a", "]"}]}], ",", 
         RowBox[{"Cos", "[", "b", "]"}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NMagn", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"P", ".", 
        RowBox[{"Magn", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "1", ",", " ", 
         RowBox[{"Length", "[", 
          RowBox[{"M", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"G", "=", 
      RowBox[{"ArcTan", "[", 
       RowBox[{
        RowBox[{"NMagn", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"NMagn", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"F", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", "c", "]"}], ",", 
         RowBox[{"Sin", "[", "c", "]"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Sin", "[", "c", "]"}]}], ",", 
         RowBox[{"Cos", "[", "c", "]"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"J", "=", 
     RowBox[{"F", ".", "P"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NewMagn", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"F", ".", 
        RowBox[{"NMagn", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "1", ",", " ", 
         RowBox[{"Length", "[", 
          RowBox[{"M", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NewAksel", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"J", ".", 
        RowBox[{"Aksel", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"M", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"kren", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ArcTan", "[", 
         RowBox[{
          RowBox[{"NewAksel", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", 
          RowBox[{"NewAksel", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"M", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tangash", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ArcTan", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"NewAksel", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"kren", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"NewAksel", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "3"}], "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"kren", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], ")"}], ",", 
          RowBox[{"-", 
           RowBox[{"NewAksel", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"M", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"curs", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ArcTan", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"NewMagn", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"tangash", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"NewMagn", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"tangash", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"kren", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"NewMagn", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "3"}], "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"tangash", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"kren", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], ")"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"NewMagn", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "3"}], "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"kren", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"NewMagn", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"kren", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], ")"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"M", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{
  3.774868952195608*^9, {3.7750436625435886`*^9, 3.77504366990221*^9}, {
   3.7750438448916035`*^9, 3.775043851927216*^9}, {3.7750439107549186`*^9, 
   3.7750439139529243`*^9}, {3.775044596937852*^9, 
   3.775044629604309*^9}},ExpressionUUID->"3c0f5412-6477-4824-b23a-\
746f3011722d"],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{\\\"M\\\", \\\"\[LeftDoubleBracket]\
\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is longer than depth of \
object.\"",2,5,1,20213767298318172613,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.775043731557406*^9, 3.7750438551564217`*^9, 
  3.7750439001625*^9, 3.7750439370097647`*^9, 3.7750446316167126`*^9, 
  3.775100727514581*^9},ExpressionUUID->"dd56c86f-eca3-457d-92ac-\
16c44d47e403"],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{\\\"Magn\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is \
longer than depth of object.\"",2,5,2,20213767298318172613,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.775043731557406*^9, 3.7750438551564217`*^9, 
  3.7750439001625*^9, 3.7750439370097647`*^9, 3.7750446316167126`*^9, 
  3.775100727530181*^9},ExpressionUUID->"a13a9ce8-f4d5-4899-8389-\
3c10c10839df"],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{\\\"Magn\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"2\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is \
longer than depth of object.\"",2,5,3,20213767298318172613,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.775043731557406*^9, 3.7750438551564217`*^9, 
  3.7750439001625*^9, 3.7750439370097647`*^9, 3.7750446316167126`*^9, 
  3.775100727545781*^9},ExpressionUUID->"faea8e18-2989-4331-809e-\
29fd9bc2d36c"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"partd\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,5,4,20213767298318172613,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.775043731557406*^9, 3.7750438551564217`*^9, 
  3.7750439001625*^9, 3.7750439370097647`*^9, 3.7750446316167126`*^9, 
  3.7751007275613813`*^9},ExpressionUUID->"b5c9d414-c562-4de3-876b-\
bf36b7bd4d6c"],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{\\\"M\\\", \\\"\[LeftDoubleBracket]\
\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is longer than depth of \
object.\"",2,8,6,20213767298318172613,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.775043731557406*^9, 3.7750438551564217`*^9, 
  3.7750439001625*^9, 3.7750439370097647`*^9, 3.7750446316167126`*^9, 
  3.7751007275769815`*^9},ExpressionUUID->"ffb59666-61ef-40f1-a25b-\
f03d08efadc2"],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{\\\"M\\\", \\\"\[LeftDoubleBracket]\
\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is longer than depth of \
object.\"",2,9,7,20213767298318172613,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.775043731557406*^9, 3.7750438551564217`*^9, 
  3.7750439001625*^9, 3.7750439370097647`*^9, 3.7750446316167126`*^9, 
  3.7751007275925817`*^9},ExpressionUUID->"134d164c-ec92-4d3e-ae70-\
bc151fc7a391"],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{\\\"Aksel\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is \
longer than depth of object.\"",2,9,8,20213767298318172613,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.775043731557406*^9, 3.7750438551564217`*^9, 
  3.7750439001625*^9, 3.7750439370097647`*^9, 3.7750446316167126`*^9, 
  3.775100727608182*^9},ExpressionUUID->"0b3d4a9b-ece5-4a3f-aa5d-\
e1ff9115ac14"],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{\\\"Aksel\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"2\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is \
longer than depth of object.\"",2,9,9,20213767298318172613,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.775043731557406*^9, 3.7750438551564217`*^9, 
  3.7750439001625*^9, 3.7750439370097647`*^9, 3.7750446316167126`*^9, 
  3.775100727608182*^9},ExpressionUUID->"e33f89d2-56a4-4386-8f27-\
455b354292c3"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"partd\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,9,10,20213767298318172613,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.775043731557406*^9, 3.7750438551564217`*^9, 
  3.7750439001625*^9, 3.7750439370097647`*^9, 3.7750446316167126`*^9, 
  3.7751007276237817`*^9},ExpressionUUID->"fe6986e2-98ee-4463-af2e-\
749b8f0e0049"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7750338624574766`*^9, 3.7750338636118784`*^9}, 
   3.7750436609659853`*^9},ExpressionUUID->"d81e65c6-9c68-48f8-ad6a-\
e87b5cf11652"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.775043284043272*^9, 3.7750432843552723`*^9}, {
   3.7750433440565767`*^9, 3.7750434002634745`*^9}, 
   3.7750436536737204`*^9},ExpressionUUID->"53ed77cc-fad7-4c6d-8df3-\
0f265720c679"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7750433388773675`*^9, 
  3.7750433388929677`*^9}},ExpressionUUID->"2d70dcca-46b3-4a35-93ca-\
bf48846943a3"],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.7750433371925645`*^9},ExpressionUUID->"a9336f64-2015-4cc1-9798-\
9edaac9c530f"],

Cell[BoxData[
 TemplateBox[{
  "Transpose","nmtx",
   "\:f3b5The first two levels of \!\({\*FractionBox[\(\*FractionBox[\(Aksel\
\[LeftDoubleBracket]1\[RightDoubleBracket]\[Cross]Magn\[LeftDoubleBracket]1\
\[RightDoubleBracket]\), \
\(Norm[Part[\[LeftSkeleton]2\[RightSkeleton]]\[Cross]Part[\[LeftSkeleton]2\
\[RightSkeleton]]]\)]\[Cross]Aksel\[LeftDoubleBracket]1\[RightDoubleBracket]\)\
, \(Norm[\*FractionBox[\(Part[\[LeftSkeleton]2\[RightSkeleton]]\[Cross]Part[\
\[LeftSkeleton]2\[RightSkeleton]]\), \(Norm[\[LeftSkeleton]1\[RightSkeleton]]\
\)]\[Cross]Aksel\[LeftDoubleBracket]1\[RightDoubleBracket]]\)], \
\*FractionBox[\(Aksel\[LeftDoubleBracket]1\[RightDoubleBracket]\[Cross]Magn\
\[LeftDoubleBracket]1\[RightDoubleBracket]\), \
\(Norm[Aksel\[LeftDoubleBracket]1\[RightDoubleBracket]\[Cross]Magn\
\[LeftDoubleBracket]1\[RightDoubleBracket]]\)], \*FractionBox[\(Aksel\
\[LeftDoubleBracket]1\[RightDoubleBracket]\), \
\(Norm[Aksel\[LeftDoubleBracket]1\[RightDoubleBracket]]\)]}\) cannot be \
transposed.\:f3b5",2,10,11,20213360568593782054,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{3.775043307178112*^9, 3.775103176881366*^9, 
  3.775108833606124*^9},ExpressionUUID->"a8a5ba87-f4e1-4f00-8409-\
666c240b2252"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.77510317917457*^9, 
  3.7751031791901703`*^9}},ExpressionUUID->"cb30404f-9d44-4b4a-a75b-\
f0324ad56202"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7751025333022437`*^9, 3.775102537576651*^9}, 
   3.7751031813273735`*^9},ExpressionUUID->"2a6a6e7d-514e-4f51-8317-\
cb0be7c99e9c"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7751029005736837`*^9, 3.775102902898088*^9}, 
   3.775103182762576*^9},ExpressionUUID->"988aa89b-f420-446c-9204-\
54157c661e2c"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.775103674584634*^9},ExpressionUUID->"86cf2da2-da03-4609-b947-\
6500ea1b5306"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7751073564772167`*^9, 3.7751074538053784`*^9}, 
   3.775108825104109*^9},ExpressionUUID->"ad2c2042-784b-4014-9d90-\
d4d7f7ff66f8"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7751048939139595`*^9, 3.775104966890887*^9}, 
   3.775107353948473*^9},ExpressionUUID->"33b9aaa2-2ce2-4507-a307-\
6e2d93f4c8d8"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7751050803654847`*^9, 3.7751051084767337`*^9}, {
  3.7751051921864796`*^9, 
  3.7751051954000854`*^9}},ExpressionUUID->"6f018ef3-1f9c-400b-b68c-\
84bcbf8ee7c3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"alpha", "[", "i", "]"}], "]"}], ",", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{"alpha", "[", "i", "]"}], "]"}]}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"alpha", "[", "i", "]"}], "]"}], ",", 
      RowBox[{"Cos", "[", 
       RowBox[{"alpha", "[", "i", "]"}], "]"}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], ".", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"beta", "[", "i", "]"}], "]"}], ",", "0", ",", 
      RowBox[{"Sin", "[", 
       RowBox[{"beta", "[", "i", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{"beta", "[", "i", "]"}], "]"}]}], ",", "0", ",", 
      RowBox[{"Cos", "[", 
       RowBox[{"beta", "[", "i", "]"}], "]"}]}], "}"}]}], "}"}], ".", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"Cos", "[", 
       RowBox[{"gamma", "[", "i", "]"}], "]"}], ",", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{"gamma", "[", "i", "]"}], "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"Sin", "[", 
       RowBox[{"gamma", "[", "i", "]"}], "]"}], ",", 
      RowBox[{"Cos", "[", 
       RowBox[{"gamma", "[", "i", "]"}], "]"}]}], "}"}]}], "}"}], ".", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"nmagx", "[", "i", "]"}], ",", 
    RowBox[{"nmagy", "[", "i", "]"}], ",", 
    RowBox[{"nmagz", "[", "i", "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.775108484836315*^9, 3.7751086075929294`*^9}, {
   3.775108696138684*^9, 3.7751087383211575`*^9}, 3.7751092618892703`*^9, {
   3.7751116309548798`*^9, 3.7751116688005457`*^9}, {3.7751117809647417`*^9, 
   3.7751117943495646`*^9}, {3.7751118852977233`*^9, 
   3.7751119474014316`*^9}},ExpressionUUID->"c4aaf6ea-ea31-432c-8dc3-\
3c640b9e2836"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"alpha", "[", "i", "]"}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"beta", "[", "i", "]"}], "]"}], " ", 
     RowBox[{"nmagx", "[", "i", "]"}]}], "+", 
    RowBox[{
     RowBox[{"nmagz", "[", "i", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"alpha", "[", "i", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"gamma", "[", "i", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"beta", "[", "i", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"alpha", "[", "i", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"gamma", "[", "i", "]"}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"nmagy", "[", "i", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", 
          RowBox[{"gamma", "[", "i", "]"}], "]"}]}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"alpha", "[", "i", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"alpha", "[", "i", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"beta", "[", "i", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"gamma", "[", "i", "]"}], "]"}]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"beta", "[", "i", "]"}], "]"}], " ", 
     RowBox[{"nmagx", "[", "i", "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"alpha", "[", "i", "]"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"nmagz", "[", "i", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"gamma", "[", "i", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"alpha", "[", "i", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"beta", "[", "i", "]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"alpha", "[", "i", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"gamma", "[", "i", "]"}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"nmagy", "[", "i", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"alpha", "[", "i", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"gamma", "[", "i", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"alpha", "[", "i", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"beta", "[", "i", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"gamma", "[", "i", "]"}], "]"}]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"beta", "[", "i", "]"}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"gamma", "[", "i", "]"}], "]"}], " ", 
     RowBox[{"nmagz", "[", "i", "]"}]}], "-", 
    RowBox[{
     RowBox[{"nmagx", "[", "i", "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"beta", "[", "i", "]"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"beta", "[", "i", "]"}], "]"}], " ", 
     RowBox[{"nmagy", "[", "i", "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"gamma", "[", "i", "]"}], "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.775108718072322*^9, 3.77510873986556*^9}, {
   3.7751116429981008`*^9, 3.775111672216952*^9}, 
   3.775111956043847*^9},ExpressionUUID->"78ddc64e-4f0d-440b-8858-\
e7d1b7dbd17b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"Em", "-", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"k11", "[", 
          RowBox[{"i", "+", "1"}], "]"}], ",", 
         RowBox[{"k12", "[", 
          RowBox[{"i", "+", "1"}], "]"}], ",", 
         RowBox[{"k13", "[", 
          RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"k21", "[", 
          RowBox[{"i", "+", "1"}], "]"}], ",", 
         RowBox[{"k22", "[", 
          RowBox[{"i", "+", "1"}], "]"}], ",", 
         RowBox[{"k23", "[", 
          RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"k31", "[", 
          RowBox[{"i", "+", "1"}], "]"}], ",", 
         RowBox[{"k32", "[", 
          RowBox[{"i", "+", "1"}], "]"}], ",", 
         RowBox[{"k33", "[", 
          RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}]}], ")"}], ".", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pm11", "[", 
        RowBox[{"i", "+", "1"}], "]"}], ",", 
       RowBox[{"pm12", "[", 
        RowBox[{"i", "+", "1"}], "]"}], ",", 
       RowBox[{"pm13", "[", 
        RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pm21", "[", 
        RowBox[{"i", "+", "1"}], "]"}], ",", 
       RowBox[{"pm22", "[", 
        RowBox[{"i", "+", "1"}], "]"}], ",", 
       RowBox[{"pm23", "[", 
        RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pm31", "[", 
        RowBox[{"i", "+", "1"}], "]"}], ",", 
       RowBox[{"pm32", "[", 
        RowBox[{"i", "+", "1"}], "]"}], ",", 
       RowBox[{"pm33", "[", 
        RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}]}], ")"}]], "Input",Ex\
pressionUUID->"883a61a9-5128-438f-a500-521ed21dae3d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"k11", "[", 
          RowBox[{"1", "+", "i"}], "]"}]}], ")"}], " ", 
       RowBox[{"pm11", "[", 
        RowBox[{"1", "+", "i"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"k12", "[", 
        RowBox[{"1", "+", "i"}], "]"}], " ", 
       RowBox[{"pm21", "[", 
        RowBox[{"1", "+", "i"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"k13", "[", 
        RowBox[{"1", "+", "i"}], "]"}], " ", 
       RowBox[{"pm31", "[", 
        RowBox[{"1", "+", "i"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"k11", "[", 
          RowBox[{"1", "+", "i"}], "]"}]}], ")"}], " ", 
       RowBox[{"pm12", "[", 
        RowBox[{"1", "+", "i"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"k12", "[", 
        RowBox[{"1", "+", "i"}], "]"}], " ", 
       RowBox[{"pm22", "[", 
        RowBox[{"1", "+", "i"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"k13", "[", 
        RowBox[{"1", "+", "i"}], "]"}], " ", 
       RowBox[{"pm32", "[", 
        RowBox[{"1", "+", "i"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"k11", "[", 
          RowBox[{"1", "+", "i"}], "]"}]}], ")"}], " ", 
       RowBox[{"pm13", "[", 
        RowBox[{"1", "+", "i"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"k12", "[", 
        RowBox[{"1", "+", "i"}], "]"}], " ", 
       RowBox[{"pm23", "[", 
        RowBox[{"1", "+", "i"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"k13", "[", 
        RowBox[{"1", "+", "i"}], "]"}], " ", 
       RowBox[{"pm33", "[", 
        RowBox[{"1", "+", "i"}], "]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"k21", "[", 
         RowBox[{"1", "+", "i"}], "]"}]}], " ", 
       RowBox[{"pm11", "[", 
        RowBox[{"1", "+", "i"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"k22", "[", 
          RowBox[{"1", "+", "i"}], "]"}]}], ")"}], " ", 
       RowBox[{"pm21", "[", 
        RowBox[{"1", "+", "i"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"k23", "[", 
        RowBox[{"1", "+", "i"}], "]"}], " ", 
       RowBox[{"pm31", "[", 
        RowBox[{"1", "+", "i"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"k21", "[", 
         RowBox[{"1", "+", "i"}], "]"}]}], " ", 
       RowBox[{"pm12", "[", 
        RowBox[{"1", "+", "i"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"k22", "[", 
          RowBox[{"1", "+", "i"}], "]"}]}], ")"}], " ", 
       RowBox[{"pm22", "[", 
        RowBox[{"1", "+", "i"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"k23", "[", 
        RowBox[{"1", "+", "i"}], "]"}], " ", 
       RowBox[{"pm32", "[", 
        RowBox[{"1", "+", "i"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"k21", "[", 
         RowBox[{"1", "+", "i"}], "]"}]}], " ", 
       RowBox[{"pm13", "[", 
        RowBox[{"1", "+", "i"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"k22", "[", 
          RowBox[{"1", "+", "i"}], "]"}]}], ")"}], " ", 
       RowBox[{"pm23", "[", 
        RowBox[{"1", "+", "i"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"k23", "[", 
        RowBox[{"1", "+", "i"}], "]"}], " ", 
       RowBox[{"pm33", "[", 
        RowBox[{"1", "+", "i"}], "]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"k31", "[", 
         RowBox[{"1", "+", "i"}], "]"}]}], " ", 
       RowBox[{"pm11", "[", 
        RowBox[{"1", "+", "i"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"k32", "[", 
        RowBox[{"1", "+", "i"}], "]"}], " ", 
       RowBox[{"pm21", "[", 
        RowBox[{"1", "+", "i"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"k33", "[", 
          RowBox[{"1", "+", "i"}], "]"}]}], ")"}], " ", 
       RowBox[{"pm31", "[", 
        RowBox[{"1", "+", "i"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"k31", "[", 
         RowBox[{"1", "+", "i"}], "]"}]}], " ", 
       RowBox[{"pm12", "[", 
        RowBox[{"1", "+", "i"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"k32", "[", 
        RowBox[{"1", "+", "i"}], "]"}], " ", 
       RowBox[{"pm22", "[", 
        RowBox[{"1", "+", "i"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"k33", "[", 
          RowBox[{"1", "+", "i"}], "]"}]}], ")"}], " ", 
       RowBox[{"pm32", "[", 
        RowBox[{"1", "+", "i"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"k31", "[", 
         RowBox[{"1", "+", "i"}], "]"}]}], " ", 
       RowBox[{"pm13", "[", 
        RowBox[{"1", "+", "i"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"k32", "[", 
        RowBox[{"1", "+", "i"}], "]"}], " ", 
       RowBox[{"pm23", "[", 
        RowBox[{"1", "+", "i"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"k33", "[", 
          RowBox[{"1", "+", "i"}], "]"}]}], ")"}], " ", 
       RowBox[{"pm33", "[", 
        RowBox[{"1", "+", "i"}], "]"}]}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.775136625318411*^9},ExpressionUUID->"ebd889e9-858b-4a54-960b-\
b02f8083ec62"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"<<", "Quaternions`"}]}]], "Input",
 CellChangeTimes->{{3.7759824248371077`*^9, 
  3.7759824351175256`*^9}},ExpressionUUID->"e42bb6d5-36cc-4395-92bf-\
625205ee37c7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Quaternion", "[", 
   RowBox[{"b0", ",", 
    RowBox[{"-", "b1"}], ",", 
    RowBox[{"-", "b2"}], ",", 
    RowBox[{"-", "b3"}]}], "]"}], "**", 
  RowBox[{"Quaternion", "[", 
   RowBox[{
    RowBox[{"KW0", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
    ",", 
    RowBox[{"KX0", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
    ",", 
    RowBox[{"KY0", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
    ",", 
    RowBox[{"KZ0", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7759824378787303`*^9, 
  3.775982502275643*^9}},ExpressionUUID->"c4ebed2f-5cda-476c-9276-\
53d4ab6a5059"],

Cell[BoxData[
 TemplateBox[{
  "Part","pkspec1",
   "\"The expression \\!\\(\\*RowBox[{\\\"i\\\"}]\\) cannot be used as a part \
specification.\"",2,3,2,20219545712021731990,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.775982503648445*^9},ExpressionUUID->"05de4bcb-5337-4784-b293-\
09a56c79b5a2"],

Cell[BoxData[
 TemplateBox[{
  "Part","pkspec1",
   "\"The expression \\!\\(\\*RowBox[{\\\"i\\\"}]\\) cannot be used as a part \
specification.\"",2,3,3,20219545712021731990,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.775982503648445*^9},ExpressionUUID->"bdfa47ba-fe2c-479c-8810-\
36d2760817bd"],

Cell[BoxData[
 TemplateBox[{
  "Part","pkspec1",
   "\"The expression \\!\\(\\*RowBox[{\\\"i\\\"}]\\) cannot be used as a part \
specification.\"",2,3,4,20219545712021731990,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.775982503648445*^9},ExpressionUUID->"05b1cac0-b195-4e1c-9a71-\
bbb00deb2f4a"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"pkspec1\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,3,5,20219545712021731990,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.7759825036640453`*^9},ExpressionUUID->"eec1ea0d-5bdb-4fdc-9b19-\
2678d13ee191"],

Cell[BoxData[
 RowBox[{"Quaternion", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"b0", " ", 
     RowBox[{"KW0", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
    "+", 
    RowBox[{"b1", " ", 
     RowBox[{"KX0", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
    "+", 
    RowBox[{"b2", " ", 
     RowBox[{"KY0", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
    "+", 
    RowBox[{"b3", " ", 
     RowBox[{
     "KZ0", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "b1"}], " ", 
     RowBox[{"KW0", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
    "+", 
    RowBox[{"b0", " ", 
     RowBox[{"KX0", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
    "+", 
    RowBox[{"b3", " ", 
     RowBox[{"KY0", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
    "-", 
    RowBox[{"b2", " ", 
     RowBox[{
     "KZ0", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "b2"}], " ", 
     RowBox[{"KW0", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
    "-", 
    RowBox[{"b3", " ", 
     RowBox[{"KX0", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
    "+", 
    RowBox[{"b0", " ", 
     RowBox[{"KY0", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
    "+", 
    RowBox[{"b1", " ", 
     RowBox[{
     "KZ0", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "b3"}], " ", 
     RowBox[{"KW0", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
    "+", 
    RowBox[{"b2", " ", 
     RowBox[{"KX0", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
    "-", 
    RowBox[{"b1", " ", 
     RowBox[{"KY0", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
    "+", 
    RowBox[{"b0", " ", 
     RowBox[{
     "KZ0", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}]}], 
  "]"}]], "Output",
 CellChangeTimes->{
  3.7759825036796455`*^9},ExpressionUUID->"b5abb4a5-40c4-4664-9fd8-\
d2a39980aa55"]
}, Open  ]]
},
WindowSize->{944, 992},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"11.1 for Microsoft Windows (64-bit) (March 13, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1062, 19, 68, "Input", "ExpressionUUID" -> \
"38ef253f-3652-443b-a37b-359962bd9c97"],
Cell[1623, 41, 2118, 59, 196, "Input", "ExpressionUUID" -> \
"4b94e030-90f5-4608-ae57-3c1c51bb50e5"],
Cell[3744, 102, 1491, 34, 47, "Input", "ExpressionUUID" -> \
"32c9b2b3-3a4d-4b61-9f20-f6a60436a0ae"],
Cell[5238, 138, 1097, 28, 50, "Input", "ExpressionUUID" -> \
"7eb8e575-f850-46b9-8208-dfc33f54c57d"],
Cell[6338, 168, 3728, 86, 159, "Input", "ExpressionUUID" -> \
"b750d39a-c643-4abc-b4b6-9646b5e35c42"],
Cell[10069, 256, 1052, 15, 30, "Input", "ExpressionUUID" -> \
"2d5d8122-c25a-41bb-9331-932a118e6310"],
Cell[11124, 273, 255, 4, 30, "Input", "ExpressionUUID" -> \
"b25c0d92-cd39-449b-bf44-2ae026f22268"],
Cell[CellGroupData[{
Cell[11404, 281, 2686, 68, 177, "Input", "ExpressionUUID" -> \
"e3817934-65b9-49be-b0b8-4680429eb16d"],
Cell[14093, 351, 632, 18, 30, "Output", "ExpressionUUID" -> \
"3ebb4ca3-57af-43f8-b445-0e467f629141"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14762, 374, 389, 7, 30, "Input", "ExpressionUUID" -> \
"c746cff6-2c0b-4b8b-9d4c-3cf1f9f34143"],
Cell[15154, 383, 604, 16, 33, "Output", "ExpressionUUID" -> \
"43002550-be27-4ab5-a4f7-4c74497bd091"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15795, 404, 2531, 77, 253, "Input", "ExpressionUUID" -> \
"53c6153d-d232-4c71-aac5-4c7be1a31308"],
Cell[18329, 483, 173, 3, 30, "Output", "ExpressionUUID" -> \
"52e6393f-ac6d-4725-8572-bf689792c63a"],
Cell[18505, 488, 572, 12, 21, "Message", "ExpressionUUID" -> \
"3504b344-60ca-4eef-a132-3d68afdb023d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19114, 505, 98311, 2465, 4473, "Input", "ExpressionUUID" -> \
"e05c0e86-3643-4412-8e67-e5763794b586"],
Cell[117428, 2972, 537, 11, 21, "Message", "ExpressionUUID" -> \
"e704afe9-99f4-4a48-8def-33ed63291043"],
Cell[117968, 2985, 537, 11, 21, "Message", "ExpressionUUID" -> \
"c36beb4b-e1d8-4de1-a9c1-d2554ad0de47"],
Cell[118508, 2998, 537, 11, 21, "Message", "ExpressionUUID" -> \
"6f8ecfaf-e606-4596-8900-0b18a9fd7832"],
Cell[119048, 3011, 609, 12, 21, "Message", "ExpressionUUID" -> \
"66c3b05f-09c7-4bd2-9aa7-af1f7978a32f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[119694, 3028, 1002, 19, 145, "Input", "ExpressionUUID" -> \
"2a96bc4a-c463-47e5-a4cd-495a4a03a2c4"],
Cell[120699, 3049, 2501, 74, 69, "Output", "ExpressionUUID" -> \
"4bcb431c-28b9-4af7-844a-cfde43d6dde3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123237, 3128, 361, 10, 30, "Input", "ExpressionUUID" -> \
"2869d549-090d-4548-9be6-8c2547eea00e"],
Cell[123601, 3140, 354, 9, 30, "Output", "ExpressionUUID" -> \
"6a4e47c7-41e4-4b75-9647-6188914cbec8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123992, 3154, 8480, 245, 482, "Input", "ExpressionUUID" -> \
"3c0f5412-6477-4824-b23a-746f3011722d"],
Cell[132475, 3401, 511, 10, 21, "Message", "ExpressionUUID" -> \
"dd56c86f-eca3-457d-92ac-16c44d47e403"],
Cell[132989, 3413, 514, 10, 21, "Message", "ExpressionUUID" -> \
"a13a9ce8-f4d5-4899-8389-3c10c10839df"],
Cell[133506, 3425, 514, 10, 21, "Message", "ExpressionUUID" -> \
"faea8e18-2989-4331-809e-29fd9bc2d36c"],
Cell[134023, 3437, 515, 10, 21, "Message", "ExpressionUUID" -> \
"b5c9d414-c562-4de3-876b-bf36b7bd4d6c"],
Cell[134541, 3449, 513, 10, 21, "Message", "ExpressionUUID" -> \
"ffb59666-61ef-40f1-a25b-f03d08efadc2"],
Cell[135057, 3461, 513, 10, 21, "Message", "ExpressionUUID" -> \
"134d164c-ec92-4d3e-ae70-bc151fc7a391"],
Cell[135573, 3473, 515, 10, 21, "Message", "ExpressionUUID" -> \
"0b3d4a9b-ece5-4a3f-aa5d-e1ff9115ac14"],
Cell[136091, 3485, 515, 10, 21, "Message", "ExpressionUUID" -> \
"e33f89d2-56a4-4386-8f27-455b354292c3"],
Cell[136609, 3497, 516, 10, 21, "Message", "ExpressionUUID" -> \
"fe6986e2-98ee-4463-af2e-749b8f0e0049"]
}, Open  ]],
Cell[137140, 3510, 181, 3, 30, "Input", "ExpressionUUID" -> \
"d81e65c6-9c68-48f8-ad6a-e87b5cf11652"],
Cell[137324, 3515, 252, 4, 50, "Input", "ExpressionUUID" -> \
"53ed77cc-fad7-4c6d-8df3-0f265720c679"],
Cell[137579, 3521, 156, 3, 30, "Input", "ExpressionUUID" -> \
"2d70dcca-46b3-4a35-93ca-bf48846943a3"],
Cell[CellGroupData[{
Cell[137760, 3528, 130, 3, 30, "Input", "ExpressionUUID" -> \
"a9336f64-2015-4cc1-9798-9edaac9c530f"],
Cell[137893, 3533, 1292, 23, 67, "Message", "ExpressionUUID" -> \
"a8a5ba87-f4e1-4f00-8409-666c240b2252"]
}, Open  ]],
Cell[139200, 3559, 153, 3, 30, "Input", "ExpressionUUID" -> \
"cb30404f-9d44-4b4a-a75b-f0324ad56202"],
Cell[139356, 3564, 179, 3, 30, "Input", "ExpressionUUID" -> \
"2a6a6e7d-514e-4f51-8317-cb0be7c99e9c"],
Cell[139538, 3569, 177, 3, 30, "Input", "ExpressionUUID" -> \
"988aa89b-f420-446c-9204-54157c661e2c"],
Cell[139718, 3574, 128, 3, 30, "Input", "ExpressionUUID" -> \
"86cf2da2-da03-4609-b947-6500ea1b5306"],
Cell[139849, 3579, 179, 3, 30, "Input", "ExpressionUUID" -> \
"ad2c2042-784b-4014-9d90-d4d7f7ff66f8"],
Cell[140031, 3584, 177, 3, 30, "Input", "ExpressionUUID" -> \
"33b9aaa2-2ce2-4507-a307-6e2d93f4c8d8"],
Cell[140211, 3589, 209, 4, 30, "Input", "ExpressionUUID" -> \
"6f018ef3-1f9c-400b-b68c-84bcbf8ee7c3"],
Cell[CellGroupData[{
Cell[140445, 3597, 2231, 63, 121, "Input", "ExpressionUUID" -> \
"c4aaf6ea-ea31-432c-8dc3-3c640b9e2836"],
Cell[142679, 3662, 3579, 102, 145, "Output", "ExpressionUUID" -> \
"78ddc64e-4f0d-440b-8858-e7d1b7dbd17b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[146295, 3769, 1888, 57, 50, "Input", "ExpressionUUID" -> \
"883a61a9-5128-438f-a500-521ed21dae3d"],
Cell[148186, 3828, 5597, 179, 183, "Output", "ExpressionUUID" -> \
"ebd889e9-858b-4a54-960b-b02f8083ec62"]
}, Open  ]],
Cell[153798, 4010, 222, 5, 50, "Input", "ExpressionUUID" -> \
"e42bb6d5-36cc-4395-92bf-625205ee37c7"],
Cell[CellGroupData[{
Cell[154045, 4019, 707, 19, 30, "Input", "ExpressionUUID" -> \
"c4ebed2f-5cda-476c-9276-53d4ab6a5059"],
Cell[154755, 4040, 326, 8, 21, "Message", "ExpressionUUID" -> \
"05de4bcb-5337-4784-b293-09a56c79b5a2"],
Cell[155084, 4050, 326, 8, 21, "Message", "ExpressionUUID" -> \
"bdfa47ba-fe2c-479c-8810-36d2760817bd"],
Cell[155413, 4060, 326, 8, 21, "Message", "ExpressionUUID" -> \
"05b1cac0-b195-4e1c-9a71-bbb00deb2f4a"],
Cell[155742, 4070, 400, 9, 21, "Message", "ExpressionUUID" -> \
"eec1ea0d-5bdb-4fdc-9b19-2678d13ee191"],
Cell[156145, 4081, 2105, 61, 83, "Output", "ExpressionUUID" -> \
"b5abb4a5-40c4-4664-9fd8-d2a39980aa55"]
}, Open  ]]
}
]
*)

